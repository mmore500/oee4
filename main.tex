\documentclass[letterpaper]{article}

\usepackage[footnotes,definitionLists,hashEnumerators,smartEllipses,hybrid]{markdown}
\usepackage{adjustbox}
\usepackage{natbib,alifeconf}  %% The order is important
\usepackage[table,xcdraw]{xcolor}
\usepackage{subcaption}
\usepackage{longtable}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{hyperref,cleveref}
\usepackage[moderate]{savetrees}
\usepackage[parfill]{parskip}
\usepackage{rotating}
\usepackage{tabularx}
\usepackage{rotating}
\usepackage{pdflscape,lipsum}
\usepackage{eso-pic,zref-user}
% \newcounter{cntsideways}
\usepackage{fancyheadings}
\usepackage{tikz}
\usetikzlibrary{calc}

\usepackage{floatpag}
\floatpagestyle{plain}
\fancypagestyle{mylandscape}{%
  \fancyhf{}% Clear header/footer
  \fancyfoot{% Footer
  % adapted from https://tex.stackexchange.com/a/9086
  \tikz[remember picture,overlay]
        \node[outer sep=0.5in,above,rotate=90] at (current page.east) {\thepage};}  \renewcommand{\headrulewidth}{0pt}% No header rule
  \renewcommand{\footrulewidth}{0pt}% No footer rule
}

% adapted from https://tex.stackexchange.com/a/472608
\usepackage{eso-pic,zref-user}
\newcounter{cntsideways}
\makeatletter
\AddToShipoutPictureBG{%
  \PLS@RemoveRotate
}
\AddToShipoutPictureBG{%
 \ifnum\zref@extractdefault{rotate\number\value{page}}{page}{0}=0
  \PLS@RemoveRotate
 \else
  \PLS@AddRotate{90}%
 \fi}

\newcommand\rotatesidewayslabel{\stepcounter{cntsideways}%
 \zlabel{tmp\thecntsideways}\zlabel{rotate\zref@extractdefault{tmp\thecntsideways}{page}{0}}}

\let\originalsidewaysfigure\sidewaysfigure
\let\endoriginalsidewaysfigure\endsidewaysfigure
\renewenvironment{sidewaysfigure}{%
  \begin{originalsidewaysfigure}%
  \thisfloatpagestyle{mylandscape}%
  \rotatesidewayslabel%
}{%
  \end{originalsidewaysfigure}%
}

% \renewenvironment{sidewaysfigure*}{%
%   \begin{originalsidewaysfigure}%
%   \thisfloatpagestyle{mylandscape}%
%   \rotatesidewayslabel%
% }{%
%   \end{originalsidewaysfigure}%
% }

\let\originalsidewaystable\sidewaystable
\let\endoriginalsidewaystable\endsidewaystable
\renewenvironment{sidewaystable}{%
  \begin{originalsidewaystable}%
  \thisfloatpagestyle{mylandscape}%
  \rotatesidewayslabel%
}{%
  \end{originalsidewaystable}%
}
\renewenvironment{sidewaystable*}{%
  \begin{originalsidewaystable}%
  \thisfloatpagestyle{mylandscape}%
  \rotatesidewayslabel%
}{%
  \end{originalsidewaystable}%
}

\let\originallandscape\landscape
\let\endoriginallandscape\endlandscape
\renewenvironment{landscape}{%
  \begin{originallandscape}%
  \thispagestyle{mylandscape}%
  \rotatesidewayslabel%
}{%
  \end{originallandscape}%
}

\makeatother

%%% Renew command for full page figures:
\renewcommand{\topfraction}{1.0}

% Blank page (if needed)
\newcommand\blankpage{%
    \null
    \thispagestyle{empty}%
    \addtocounter{page}{-1}%
    \newpage}


% pragma once, adapted from https://tex.stackexchange.com/a/195173
\makeatletter
\let\pragma@iinput=\@iinput
\def\@iinput#1{\xdef\@pragmafile{#1}\pragma@iinput{#1}}
\def\@pragmafile{default}
\def\pragmaonce{%
   \csname pragma@\@pragmafile\endcsname
   \global\expandafter\let \csname pragma@\@pragmafile\endcsname = \endinput
}
\makeatother

\ifdefined\mydraft
\mydraft
\fi

% \setcounter{tocdepth}{4}
% \setcounter{secnumdepth}{4}

% *****************
%  Requirements:
% *****************
%
% - All pages sized consistently at 8.5 x 11 inches (US letter size).
% - PDF length <= 8 pages for full papers, <=2 pages for extended
%    abstracts (not including citations).
% - Abstract length <= 250 words.
% - No visible crop marks.
% - Images at no greater than 300 dpi, scaled at 100%.
% - Embedded open type fonts only.
% - All layers flattened.
% - No attachments.
% - All desired links active in the files.

% Note that the PDF file must not exceed 5 MB if it is to be indexed
% by Google Scholar. Additional information about Google Scholar
% can be found here:
% http://www.google.com/intl/en/scholar/inclusion.html.


% If your system does not generate letter format documents by default,
% you can use the following workflow:
% latex example
% bibtex example
% latex example ; latex example
% dvips -o example.ps -t letterSize example.dvi
% ps2pdf example.ps example.pdf


% For pdflatex users:
% The alifeconf style file loads the "graphicx" package, and
% this may lead some users of pdflatex to experience problems.
% These can be fixed by editing the alifeconf.sty file to specify:
% \usepackage[pdftex]{graphicx}
%   instead of
% \usepackage{graphicx}.
% The PDF output generated by pdflatex should match the required
% specifications and obviously the dvips and ps2pdf steps become
% unnecessary.


% Note:  Some laser printers have a serious problem printing TeX
% output. The use of ps type I fonts should avoid this problem.

\input{tex/frontmatter.tex}

\begin{document}
\maketitle

\input{tex/abstract.tex}

\input{tex/body.tex}

\input{tex/acknowledgements.tex}

\footnotesize
\bibliographystyle{apalike}
\bibliography{bibl} % replace by the name of your .bib file

\clearpage
\newpage

\appendix

\input{tex/appendix.tex}

\end{document}
